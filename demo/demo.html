<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>按照汉字首字拼音排序</title>
    <style media="screen">

        .box li {
            list-style: none;
            line-height: 35px;
            font-size: 15px;
        }
        .sort-letter {
            color: #f00;
        }
    </style>
    <script src="../bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
  </head>
  <body>
    <div class="box">
      <ul></ul>
    </div>
    <script src="../pysort.js" type="text/javascript"></script>
    <script type="text/javascript">
      $
        .get('demo.json', function(data) {
          var n = 0,
            len = data.length,
            catTmp = '';
          for (; n < len; n++) {
            catTmp += '<li><a data-id="' + data[n].catId + '">' + data[n].catFullName + '</a></li>';
          }
          $('.box ul').html(catTmp);
          pysort();
        })
      function pysort() {
        var SortList = $(".box ul li");
        var SortBox = $(".box ul");
        SortList.sort(asc_sort)
          .appendTo('.box ul'); //按首字母排序
        function asc_sort(a, b) {
          return makePy($(b).find('a').text().charAt(0))[0].toUpperCase() < makePy($(a).find('a').text().charAt(0))[0].toUpperCase()
            ? 1
            : -1;
        }
        var initials = [];
        var num = 0;
        SortList.each(function(i) {
          var initial = makePy($(this).find('a').text().charAt(0))[0].toUpperCase();
          if (initial >= 'A' && initial <= 'Z') {
            if (initials.indexOf(initial) === -1)
              initials.push(initial);
            }
          else {
            num++;
          }
        });

        $.each(initials, function(index, value) { //添加首字母标签
          SortBox.append('<li class="sort-letter" id="' + value + '">' + value + '</li>');
        });
        if (num != 0) {
          SortBox.append('<div class="sort-letter" id="default">#</div>');
        }

        for (var i = 0; i < SortList.length; i++) { //插入到对应的首字母后面
          var letter = makePy(SortList.eq(i).find('a').text().charAt(0))[0].toUpperCase();
          switch (letter) {
            case "A":
              $('#A').after(SortList.eq(i));
              break;
            case "B":
              $('#B').after(SortList.eq(i));
              break;
            case "C":
              $('#C').after(SortList.eq(i));
              break;
            case "D":
              $('#D').after(SortList.eq(i));
              break;
            case "E":
              $('#E').after(SortList.eq(i));
              break;
            case "F":
              $('#F').after(SortList.eq(i));
              break;
            case "G":
              $('#G').after(SortList.eq(i));
              break;
            case "H":
              $('#H').after(SortList.eq(i));
              break;
            case "I":
              $('#I').after(SortList.eq(i));
              break;
            case "J":
              $('#J').after(SortList.eq(i));
              break;
            case "K":
              $('#K').after(SortList.eq(i));
              break;
            case "L":
              $('#L').after(SortList.eq(i));
              break;
            case "M":
              $('#M').after(SortList.eq(i));
              break;
            case "N":
              $('#N').after(SortList.eq(i));
              break;
            case "O":
              $('#O').after(SortList.eq(i));
              break;
            case "P":
              $('#P').after(SortList.eq(i));
              break;
            case "Q":
              $('#Q').after(SortList.eq(i));
              break;
            case "R":
              $('#R').after(SortList.eq(i));
              break;
            case "S":
              $('#S').after(SortList.eq(i));
              break;
            case "T":
              $('#T').after(SortList.eq(i));
              break;
            case "U":
              $('#U').after(SortList.eq(i));
              break;
            case "V":
              $('#V').after(SortList.eq(i));
              break;
            case "W":
              $('#W').after(SortList.eq(i));
              break;
            case "X":
              $('#X').after(SortList.eq(i));
              break;
            case "Y":
              $('#Y').after(SortList.eq(i));
              break;
            case "Z":
              $('#Z').after(SortList.eq(i));
              break;
            default:
              $('#default').after(SortList.eq(i));
              break;
          }
        }
      }

    </script>
  </body>
</html>
